<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sports Career Simulator</title>

  <style>
    body{
      font-family: Segoe UI, Tahoma, sans-serif;
      background:#0b1220; color:white;
      padding:20px; text-align:center;
    }
    .box{
      max-width:900px; margin:auto;
      background:#111f3a; padding:18px;
      border-radius:14px;
    }
    input, select{
      padding:10px; border-radius:10px; border:none;
      width:100%; margin:6px 0 14px;
    }
    .row2{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
    button{
      padding:12px 16px; border:none; border-radius:12px;
      background:#38bdf8; font-weight:bold; cursor:pointer;
      transition:.1s;
      margin:6px;
    }
    button:hover{filter:brightness(1.08);}
    button:active{transform:translateY(2px);}
    #output{margin-top:16px;}
    table{
      width:100%; border-collapse:collapse; margin-top:14px;
      background:rgba(255,255,255,.06); border-radius:12px; overflow:hidden;
    }
    th, td{padding:10px; border-bottom:1px solid rgba(255,255,255,.1); font-size:14px;}
    th{color:#a9b6d6;}
    .small{color:#a9b6d6; font-size:13px; margin-top:8px;}
  </style>
</head>

<body>
  <div class="box">
    <h1>Interactive Sports Career Simulator</h1>
    <p class="small">Uses: variables, if/else, loops, arrays, objects, random numbers</p>

    <label>Athlete Name</label>
    <input id="name" type="text" placeholder="e.g., Sean" />

    <div class="row2">
      <div>
        <label>Starting Age (12-45)</label>
        <input id="age" type="number" min="12" max="45" value="18" />
      </div>
      <div>
        <label>Sport</label>
        <select id="sport">
          <option>Soccer</option>
          <option>Basketball</option>
          <option>Tennis</option>
          <option>Hockey</option>
          <option>Boxing</option>
        </select>
      </div>
    </div>

    <div class="row2">
      <div>
        <label>Talent (1-10)</label>
        <input id="talent" type="number" min="1" max="10" value="6" />
      </div>
      <div>
        <label>Training (1-10)</label>
        <input id="training" type="number" min="1" max="10" value="7" />
      </div>
    </div>

    <div class="row2">
      <div>
        <label>Injury Risk (1-10)</label>
        <input id="risk" type="number" min="1" max="10" value="4" />
      </div>
      <div style="display:flex; align-items:center; justify-content:center; gap:10px;">
        <input id="safe" type="checkbox" />
        <label style="margin:0;">Play Safe Mode</label>
      </div>
    </div>

    <button onclick="simulate()">Simulate Career</button>
    <button onclick="exportTxt()">Export .txt</button>
    <button onclick="resetAll()">Reset</button>

    <div id="output"></div>

    <table id="logTable" style="display:none;">
      <thead>
        <tr>
          <th>Season</th>
          <th>Age</th>
          <th>Performance</th>
          <th>Injury?</th>
          <th>Trophy?</th>
        </tr>
      </thead>
      <tbody id="logBody"></tbody>
    </table>
  </div>

  <script>
    // simple click sound (no mp3)
    function clickSound(){
      try{
        const ctx = new (window.AudioContext||window.webkitAudioContext)();
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type="square"; o.frequency.value=520;
        g.gain.value=0.06;
        o.connect(g); g.connect(ctx.destination);
        o.start();
        g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.08);
        o.stop(ctx.currentTime+0.09);
        setTimeout(()=>ctx.close(), 120);
      }catch(e){}
    }

    let lastResult = null; // for export

    function rand(min,max){ return Math.random()*(max-min)+min; }
    function clamp(n,min,max){ return Math.max(min, Math.min(max,n)); }

    function simulate(){
      clickSound();

      // read inputs
      let name = document.getElementById("name").value.trim();
      let age = parseInt(document.getElementById("age").value);
      let sport = document.getElementById("sport").value;
      let talent = parseInt(document.getElementById("talent").value);
      let training = parseInt(document.getElementById("training").value);
      let risk = parseInt(document.getElementById("risk").value);
      let safe = document.getElementById("safe").checked;

      // validation
      if(isNaN(age) || age<12 || age>45){ return showMsg("Age must be 12-45"); }
      if(isNaN(talent)||talent<1||talent>10){ return showMsg("Talent must be 1-10"); }
      if(isNaN(training)||training<1||training>10){ return showMsg("Training must be 1-10"); }
      if(isNaN(risk)||risk<1||risk>10){ return showMsg("Risk must be 1-10"); }

      // athlete object
      let athlete = {
        name: name || "Athlete",
        startAge: age,
        sport: sport,
        talent: talent,
        training: training,
        risk: risk,
        safe: safe
      };

      // career simulation (loop + random)
      let logs = [];      // array of objects
      let trophies = 0;
      let earnings = 0;
      let injuries = 0;

      let seasons = 0;
      let curAge = athlete.startAge;

      // simulate up to 20 seasons OR stop at 3 injuries OR age 40+
      for(let s=1; s<=20; s++){
        if(curAge >= 40) break;
        if(injuries >= 3) break;

        seasons++;

        // performance formula
        let perf = athlete.talent*1.3 + athlete.training*0.6 + rand(-2,2);

        // play safe lowers upside but lowers injury chance
        if(athlete.safe) perf *= 0.90;

        // injury chance
        let injuryChance = 0.05 + athlete.risk*0.03 + athlete.training*0.01;
        if(athlete.safe) injuryChance -= 0.03;
        injuryChance = clamp(injuryChance, 0.04, 0.55);

        let injured = (Math.random() < injuryChance);
        if(injured){
          injuries++;
          perf *= 0.65;
        }

        // trophy chance
        let trophyChance = clamp((perf/18)*0.25, 0.02, 0.20);
        let trophy = (Math.random() < trophyChance);
        if(trophy) trophies++;

        // simple earnings
        earnings += 300000 * clamp(perf/10, 0.4, 1.7) * (1 + trophies*0.05);

        logs.push({
          season:s, age:curAge, perf:perf,
          injured: injured, trophy: trophy
        });

        curAge++;
      }

      // score + tier
      let avgPerf = logs.reduce((sum,x)=>sum+x.perf,0) / logs.length;
      let score = clamp(Math.round(avgPerf*5 + trophies*10 - injuries*6 + seasons*2), 0, 100);

      let tier = "Developing";
      if(score>=85) tier="Legend";
      else if(score>=70) tier="Star";
      else if(score>=55) tier="Pro";
      else if(score>=40) tier="Role Player";

      lastResult = {athlete, seasons, trophies, injuries, earnings, score, tier, logs};

      // output
      document.getElementById("output").innerHTML =
        `<h2>${athlete.name} (${athlete.sport})</h2>
         <p>Tier: <b>${tier}</b> | Score: <b>${score}/100</b></p>
         <p>Seasons: <b>${seasons}</b> | Trophies: <b>${trophies}</b> | Injuries: <b>${injuries}</b></p>
         <p>Earnings (estimated): <b>$${Math.round(earnings).toLocaleString()}</b></p>`;

      // table
      let body = document.getElementById("logBody");
      body.innerHTML = "";
      for(let row of logs){
        body.innerHTML += `
          <tr>
            <td>${row.season}</td>
            <td>${row.age}</td>
            <td>${row.perf.toFixed(1)}</td>
            <td>${row.injured ? "Yes" : "No"}</td>
            <td>${row.trophy ? "Yes" : "No"}</td>
          </tr>`;
      }
      document.getElementById("logTable").style.display = "table";
    }

    function showMsg(msg){
      document.getElementById("output").innerHTML = `<p style="color:#fca5a5;"><b>${msg}</b></p>`;
      document.getElementById("logTable").style.display = "none";
    }

    function resetAll(){
      clickSound();
      lastResult = null;
      document.getElementById("output").innerHTML = "";
      document.getElementById("logBody").innerHTML = "";
      document.getElementById("logTable").style.display = "none";
    }

    function exportTxt(){
      clickSound();
      if(!lastResult){ return showMsg("Simulate first, then export."); }

      let r = lastResult;
      let lines = [];
      lines.push("Sports Career Simulator Export");
      lines.push("-----------------------------");
      lines.push(`Name: ${r.athlete.name}`);
      lines.push(`Sport: ${r.athlete.sport}`);
      lines.push(`Start Age: ${r.athlete.startAge}`);
      lines.push(`Talent: ${r.athlete.talent}/10`);
      lines.push(`Training: ${r.athlete.training}/10`);
      lines.push(`Risk: ${r.athlete.risk}/10`);
      lines.push(`Play Safe: ${r.athlete.safe ? "ON":"OFF"}`);
      lines.push("");
      lines.push(`Tier: ${r.tier}`);
      lines.push(`Score: ${r.score}/100`);
      lines.push(`Seasons: ${r.seasons}`);
      lines.push(`Trophies: ${r.trophies}`);
      lines.push(`Injuries: ${r.injuries}`);
      lines.push(`Earnings: $${Math.round(r.earnings)}`);
      lines.push("");
      lines.push("Season Log: season,age,performance,injury,trophy");
      for(let row of r.logs){
        lines.push(`${row.season},${row.age},${row.perf.toFixed(2)},${row.injured},${row.trophy}`);
      }

      const blob = new Blob([lines.join("\n")], {type:"text/plain"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "career_sim_export.txt";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>

